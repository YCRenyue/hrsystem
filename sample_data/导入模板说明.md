# Excel数据导入模板说明

本文档说明各Excel表格的字段要求和导入规范。

## 📋 通用规范

### 1. 文件格式
- 文件扩展名: `.xlsx` 或 `.xls`
- 编码格式: UTF-8
- 文件大小: 建议不超过10MB
- 最大行数: 建议每次不超过1000行

### 2. 字段规范
- 必填字段不能为空
- 日期格式统一为: `YYYY-MM-DD`
- 时间格式统一为: `HH:MM:SS`
- 数字不要使用千分位分隔符
- 布尔值使用: `是/否` 或 `true/false`

### 3. 数据验证
- 手机号: 11位数字，以13/14/15/16/17/18/19开头
- 身份证号: 18位数字或17位数字+X
- 邮箱: 标准邮箱格式 `xxx@xxx.xxx`
- 工号: 唯一标识，不可重复

## 📊 各表导入规范

### 1. 员工信息表

**文件名**: `员工信息表.xlsx`

**必填字段**:
- ✅ 工号 (唯一)
- ✅ 姓名
- ✅ 手机号
- ✅ 部门
- ✅ 职位
- ✅ 入职日期

**选填字段**:
- 性别
- 出生日期
- 身份证号
- 邮箱
- 银行卡号
- 家庭住址
- 紧急联系人
- 紧急联系电话

**数据验证规则**:
```
工号: 唯一，不可重复
姓名: 2-20个字符
手机号: 11位数字
身份证号: 18位
邮箱: 标准邮箱格式
入职日期: YYYY-MM-DD格式
员工状态: 在职/离职
```

**示例数据**:
```
工号      | 姓名  | 性别 | 手机号        | 部门   | 职位        | 入职日期
EMP0001  | 张伟  | 男   | 13812345678  | 技术部 | Java工程师  | 2023-01-15
```

---

### 2. 部门信息表

**文件名**: `部门信息表.xlsx`

**必填字段**:
- ✅ 部门名称 (唯一)
- ✅ 部门编码 (唯一)

**选填字段**:
- 上级部门
- 部门负责人
- 部门人数
- 成立日期
- 部门状态
- 部门描述

**数据验证规则**:
```
部门名称: 唯一，2-50个字符
部门编码: 唯一，大写字母和数字
上级部门: 必须是已存在的部门名称
部门状态: 启用/停用
```

**示例数据**:
```
部门名称    | 部门编码 | 上级部门 | 部门负责人 | 部门人数 | 部门状态
技术部      | TECH    | 总经办   | 张伟      | 25      | 启用
```

---

### 3. 考勤记录表

**文件名**: `考勤记录表.xlsx`

**必填字段**:
- ✅ 工号
- ✅ 考勤日期
- ✅ 上班打卡时间
- ✅ 下班打卡时间

**选填字段**:
- 姓名
- 工作时长
- 考勤状态
- 迟到分钟
- 早退分钟
- 打卡地点
- 打卡来源
- 异常说明

**数据验证规则**:
```
工号: 必须是已存在的员工工号
考勤日期: YYYY-MM-DD格式
打卡时间: HH:MM:SS格式
考勤状态: 正常/迟到/早退/缺勤/请假
工作时长: 数字，保留2位小数
```

**示例数据**:
```
工号     | 考勤日期    | 上班打卡时间 | 下班打卡时间 | 工作时长 | 考勤状态
EMP0001 | 2024-10-25 | 08:30:00   | 18:00:00   | 9.5     | 正常
```

---

### 4. 年假管理表

**文件名**: `年假管理表.xlsx`

**必填字段**:
- ✅ 工号
- ✅ 年度
- ✅ 总天数

**选填字段**:
- 姓名
- 已使用天数
- 剩余天数
- 各类假期明细
- 工龄

**数据验证规则**:
```
工号: 必须是已存在的员工工号
年度: 4位数字，如2024
总天数: 数字，保留1位小数
已使用天数 ≤ 总天数
```

**示例数据**:
```
工号     | 年度 | 总天数 | 已使用天数 | 剩余天数 | 工龄
EMP0001 | 2024 | 10.0  | 3.5       | 6.5     | 5
```

---

### 5. 社保公积金表

**文件名**: `社保公积金表.xlsx`

**必填字段**:
- ✅ 工号
- ✅ 年月
- ✅ 缴纳基数

**选填字段**:
- 姓名
- 各险种金额
- 公司合计
- 个人合计
- 缴纳状态

**数据验证规则**:
```
工号: 必须是已存在的员工工号
年月: YYYY-MM格式
缴纳基数: 正数，保留2位小数
各项金额: 正数，保留2位小数
缴纳状态: 已缴纳/待缴纳/延期
```

**示例数据**:
```
工号     | 年月    | 缴纳基数 | 养老-公司 | 养老-个人 | 公司合计 | 个人合计 | 缴纳状态
EMP0001 | 2024-10 | 10000.00| 1600.00  | 800.00   | 3500.00 | 1200.00 | 已缴纳
```

---

### 6. 出差补助表

**文件名**: `出差补助表.xlsx`

**必填字段**:
- ✅ 工号
- ✅ 出差目的地
- ✅ 开始日期
- ✅ 结束日期

**选填字段**:
- 出差单号
- 姓名
- 出差事由
- 各项补助金额
- 审批状态

**数据验证规则**:
```
工号: 必须是已存在的员工工号
日期: YYYY-MM-DD格式
结束日期 ≥ 开始日期
金额: 正数，保留2位小数
审批状态: 待审批/已批准/已拒绝/已支付
```

**示例数据**:
```
出差单号      | 工号     | 出差目的地 | 开始日期    | 结束日期    | 出差天数 | 补助总额
BT2024100001 | EMP0001 | 北京      | 2024-10-20 | 2024-10-23 | 3       | 2400.00
```

---

### 7. 就餐记录表

**文件名**: `就餐记录表.xlsx`

**必填字段**:
- ✅ 工号
- ✅ 就餐日期
- ✅ 餐次类型
- ✅ 原价金额

**选填字段**:
- 姓名
- 食堂位置
- 补贴金额
- 实付金额
- 支付方式
- 评分

**数据验证规则**:
```
工号: 必须是已存在的员工工号
就餐日期: YYYY-MM-DD格式
餐次类型: 早餐/午餐/晚餐/加餐
金额: 正数，保留2位小数
支付方式: 饭卡/手机支付/现金
评分: 1-5的整数
```

**示例数据**:
```
工号     | 就餐日期    | 餐次类型 | 原价金额 | 补贴金额 | 实付金额 | 支付方式
EMP0001 | 2024-10-25 | 午餐    | 25.00   | 15.00   | 10.00   | 饭卡
```

---

### 8. 入职流程表

**文件名**: `入职流程表.xlsx`

**必填字段**:
- ✅ 工号
- ✅ 姓名

**选填字段**:
- 流程状态
- 推送渠道
- 推送时间
- 表单完成时间
- 数据完整度
- 创建人

**数据验证规则**:
```
工号: 必须是已存在的员工工号
流程状态: 待发送/已发送/已完成/已过期
推送渠道: 钉钉/短信/邮件/手动
时间: YYYY-MM-DD HH:MM:SS格式
数据完整度: 百分比，如100%
```

**示例数据**:
```
工号     | 姓名  | 流程状态 | 推送渠道 | 推送时间            | 数据完整度
EMP0001 | 张伟  | 已完成   | 钉钉    | 2024-10-20 10:00:00| 100%
```

---

## 🔧 导入操作步骤

### 1. 准备Excel文件
1. 下载模板文件或使用生成的样本文件
2. 填写数据，注意必填字段
3. 检查数据格式是否符合规范
4. 保存文件

### 2. 上传导入
1. 登录HR系统
2. 进入相应模块的导入页面
3. 选择Excel文件
4. 点击"预览数据"检查
5. 确认无误后点击"开始导入"

### 3. 查看结果
1. 导入完成后查看导入报告
2. 成功的数据会显示成功条数
3. 失败的数据会显示错误原因
4. 下载错误明细进行修正

### 4. 处理错误
1. 下载导入失败的数据
2. 根据错误提示修正数据
3. 重新上传导入

## ⚠️ 注意事项

### 数据准备
- ✅ 使用模板文件，不要随意修改表头
- ✅ 删除示例数据行，填入真实数据
- ✅ 保持字段顺序不变
- ✅ 必填字段不能为空
- ✅ 日期和数字格式要统一

### 导入规则
- 🔄 相同工号的数据会被更新（而非新增）
- 🔄 部门、职位等需要预先在系统中存在
- 🔄 外键关联要确保数据完整性
- 🔄 大批量数据建议分批导入
- 🔄 导入前建议先备份数据库

### 常见错误
| 错误类型 | 原因 | 解决方法 |
|---------|------|---------|
| 工号重复 | Excel中有重复的工号 | 检查并删除重复项 |
| 格式错误 | 手机号、身份证号格式不对 | 按规范修改格式 |
| 外键错误 | 部门或职位不存在 | 先导入部门数据 |
| 必填项为空 | 必填字段没有填写 | 补充完整数据 |
| 日期格式错误 | 日期格式不符合要求 | 统一为YYYY-MM-DD |

## 📖 相关文档

- [样本数据生成说明](README.md)
- [API导入接口文档](../docs/api.md)
- [批量操作指南](../docs/batch-operations.md)

## 🆘 获取帮助

如有问题，请联系：
- 技术支持邮箱: support@company.com
- 系统管理员: admin@company.com
- 帮助文档: https://docs.company.com
